(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[0],{12:function(e,n,t){},14:function(e,n,t){},16:function(e,n,t){"use strict";t.r(n);var r=t(2),c=t.n(r),a=t(6),o=t.n(a),i=(t(12),t(1)),s=t.n(i),u=t(3),d=t(4),p=(t(14),t(7)),l=window.require("electron"),f=l.desktopCapturer,h=l.ipcRenderer,w=new window.RTCPeerConnection({});function b(){return v.apply(this,arguments)}function v(){return(v=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getSources({types:["screen"]});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,t){navigator.webkitGetUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n[0].id,maxWidth:window.screen.width,maxHeight:window.screen.height}}},(function(n){e(n)}),(function(e){console.error(e),t(e)}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return j.apply(this,arguments)}function j(){return(j=Object(u.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:return t=e.sent,e.next=5,w.addStream(t);case 5:return e.next=7,w.setRemoteDescription(n);case 7:return e.t0=w,e.next=10,w.createAnswer();case 10:return e.t1=e.sent,e.next=13,e.t0.setLocalDescription.call(e.t0,e.t1);case 13:return console.log("answer",JSON.stringify(w.localDescription)),e.abrupt("return",w.localDescription);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}w.ondatachannel=function(e){console.log("datachannel",e),e.chanel.onmessage=function(e){var n=e.data,t=n.type,r=n.data;"mouse"===t&&(r.screen={width:window.screen.width,height:window.screen.height}),console.log(t,"on"),h.send("robot",t,r)}},w.onicecandidate=function(e){console.log("peer-onicecandidate",e),console.log("candidate",JSON.stringify(e.candidate)),e.candidate&&h.send("forward","puppet-candidate",Object(p.a)({},e.candidate))},h.on("candidate",(function(e,n){!function(e){m.apply(this,arguments)}(n)}));var x=[];function m(){return(m=Object(u.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&x.push(n),!w.remoteDescription||!w.remoteDescription.type){e.next=10;break}t=0;case 3:if(!(t<x.length)){e.next=9;break}return e.next=6,w.addIceCandidate(new RTCIceCandidate(x[t]));case 6:t++,e.next=3;break;case 9:x=[];case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}h.on("offer",function(){var e=Object(u.a)(s.a.mark((function e(n,t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:r=e.sent,h.send("forward","answer",{type:r.type,sdp:r.sdp});case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}());var O=t(0),y=window.require("electron").ipcRenderer;console.log(window.require("@electron/remote").Menu);var k=window.require("@electron/remote"),C=k.MenuItem,S=k.Menu;console.log(y);var D=function(){var e=Object(r.useState)(""),n=Object(d.a)(e,2),t=n[0],c=n[1],a=Object(r.useState)(""),o=Object(d.a)(a,2),i=o[0],p=o[1],l=Object(r.useState)(""),f=Object(d.a)(l,2),h=f[0],w=f[1],b=function(){var e=Object(u.a)(s.a.mark((function e(){var n,t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.invoke("login");case 2:n=e.sent,t=n.code,console.log("code",t),p(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){return b(),y.on("control-state-change",v),function(){y.removeListener("control-state-change",v)}}),[]);var v=function(e,n,t){console.log("handleControlState");var r="";1===t?r="\u6b63\u5728\u63a7\u5236".concat(n):2===t&&(r="\u88ab".concat(n,"\u63a7\u5236")),w(r)};return Object(O.jsx)("div",{className:"App",children:""===h?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{children:["\u60a8\u7684\u63a7\u5236\u7801",Object(O.jsx)("span",{onContextMenu:function(e){!function(e){e.preventDefault();var n=new S;n.append(new C({label:"\u590d\u5236",role:"copy"})),n.popup()}(e)},children:i})]}),Object(O.jsx)("input",{type:"text",value:t,onChange:function(e){return c(e.target.value)}}),Object(O.jsx)("button",{onClick:function(){return function(e){console.log(e),y.send("control",e)}(t)},children:"\u786e\u8ba4"})]}):Object(O.jsx)("div",{children:h})})},M=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,17)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,a=n.getLCP,o=n.getTTFB;t(e),r(e),c(e),a(e),o(e)}))};o.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(D,{})}),document.getElementById("root")),M()}},[[16,1,2]]]);
//# sourceMappingURL=main.11ff80be.chunk.js.map